<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" type="image/.png" href="giblin logo.png">
    <title>Work Holiday Tracker - Ireland</title>
    <style>
        :root {
            --primary: #2563eb;
            --full-day: #10b981; /* Green */
            --half-day: #f59e0b; /* Orange */
            --bank-hol: #3b82f6; /* Blue */
            --bg: #f3f4f6;
            --text: #1f2937;
        }

        body {
            font-family: -apple-system, system-ui, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 10px;
        }

        .container { max-width: 800px; margin: 0 auto; background: white; padding: 15px; border-radius: 16px; }

        .dashboard {
            background: #f8fafc; padding: 15px; border-radius: 12px; border: 1px solid #e2e8f0;
            display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px;
        }

        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: center; }
        .stat-card { background: white; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .stat-card strong { display: block; font-size: 1.2rem; color: var(--primary); }

        .year-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 600px) { .year-grid { grid-template-columns: repeat(2, 1fr); } }

        .month-container { border: 1px solid #f1f5f9; border-radius: 12px; padding: 8px; }
        .month-name { text-align: center; font-weight: bold; margin-bottom: 8px; color: var(--primary); }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; text-align: center; }
        .day-header { font-size: 0.7rem; color: #94a3b8; font-weight: bold; }

        .day {
            aspect-ratio: 1; display: flex; align-items: center; justify-content: center;
            font-size: 0.85rem; border-radius: 6px; cursor: pointer; border: 1px solid transparent;
        }

        .day.full { background-color: var(--full-day) !important; color: white; font-weight: bold; }
        .day.half { background-color: var(--half-day) !important; color: white; font-weight: bold; }
        .day.bank { background-color: var(--bank-hol) !important; color: white; font-weight: bold; }
        .day.today { border: 2px solid var(--primary); font-weight: bold; }

        .legend { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.75rem; margin-top: 10px; }
        .legend-item { display: flex; align-items: center; gap: 5px; }
        .dot { width: 12px; height: 12px; border-radius: 3px; }

        .note-card { background: #f8fafc; padding: 10px; border-radius: 8px; margin-bottom: 8px; border-left: 4px solid #ddd; }
        .note-card.full { border-left-color: var(--full-day); }
        .note-card.half { border-left-color: var(--half-day); }
        .note-card.bank { border-left-color: var(--bank-hol); }
        
        input[type="text"] { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; margin-top: 5px; }
        
        .btn-row { display: flex; gap: 10px; margin-top: 20px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; }
        .btn-export { background: var(--text); }
        .btn-auto { background: var(--bank-hol); font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="dashboard">
        <div style="display:flex; gap:10px;">
            <div style="flex:1"><label>Year</label><input type="number" id="yearInput" value="2026"></div>
            <div style="flex:1"><label>Allowance (h)</label><input type="number" id="allowanceInput" value="200"></div>
        </div>
        <div class="stats-grid">
            <div class="stat-card">Used<strong id="usedDisplay">0</strong></div>
            <div class="stat-card">Left<strong id="remDisplay">0</strong></div>
        </div>
        <div class="legend">
            <div class="legend-item"><div class="dot" style="background:var(--full-day)"></div> Full (9h)</div>
            <div class="legend-item"><div class="dot" style="background:var(--half-day)"></div> Half (4h)</div>
            <div class="legend-item"><div class="dot" style="background:var(--bank-hol)"></div> Bank Holiday (0h)</div>
            <div class="legend-item"><button class="btn-auto" onclick="addIrishBanks()">+ Auto Add IE Bank Hol</button></div>
        </div>
    </div>

    <div class="year-grid" id="yearGrid"></div>

    <div style="margin-top:30px">
        <h3>Notes</h3>
        <div id="notesGrid"></div>
    </div>

    <div class="btn-row">
        <button class="btn btn-export" onclick="exportToCSV()">Download CSV</button>
    </div>
</div>

<script>
    let holidayData = JSON.parse(localStorage.getItem('holidayDataIE')) || {};
    const yearInput = document.getElementById('yearInput');
    const allowanceInput = document.getElementById('allowanceInput');

    function save() {
        localStorage.setItem('holidayDataIE', JSON.stringify(holidayData));
        localStorage.setItem('holidayAllowance', allowanceInput.value);
        updateStats();
    }

    function addIrishBanks() {
        const year = yearInput.value;
        const banks = [
            `${year}-01-01`, // New Year
            `${year}-02-02`, // St Brigid
            `${year}-03-17`, // St Patrick
            `${year}-04-06`, // Easter Mon
            `${year}-05-04`, // May Day
            `${year}-06-01`, // June
            `${year}-08-03`, // August
            `${year}-10-26`, // October
            `${year}-12-25`, // Xmas
            `${year}-12-26`  // Stephens
        ];
        banks.forEach(b => { if(!holidayData[b]) holidayData[b] = { type: 'bank', note: 'Ireland Bank Holiday' } });
        save(); renderYear();
    }

    function updateStats() {
        let used = 0;
        Object.keys(holidayData).forEach(d => {
            if (d.startsWith(yearInput.value)) {
                if (holidayData[d].type === 'full') used += 9;
                if (holidayData[d].type === 'half') used += 4;
            }
        });
        const total = parseFloat(allowanceInput.value) || 0;
        document.getElementById('usedDisplay').innerText = used + 'h';
        document.getElementById('remDisplay').innerText = (total - used) + 'h';
    }

    function renderYear() {
        const year = parseInt(yearInput.value);
        const grid = document.getElementById('yearGrid');
        grid.innerHTML = '';

        for (let m = 0; m < 12; m++) {
            const mDiv = document.createElement('div'); mDiv.className = 'month-container';
            const name = new Date(year, m).toLocaleString('default', { month: 'long' });
            mDiv.innerHTML = `<div class="month-name">${name}</div>`;
            const cal = document.createElement('div'); cal.className = 'calendar-grid';

            ['S','M','T','W','T','F','S'].forEach(d => {
                const h = document.createElement('div'); h.className = 'day-header'; h.innerText = d; cal.appendChild(h);
            });

            const first = new Date(year, m, 1).getDay();
            const days = new Date(year, m + 1, 0).getDate();

            for (let i = 0; i < first; i++) cal.appendChild(Object.assign(document.createElement('div'), {className: 'day empty'}));

            for (let i = 1; i <= days; i++) {
                const dateKey = `${year}-${String(m + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const dEl = document.createElement('div'); dEl.className = 'day'; dEl.innerText = i;

                if (holidayData[dateKey]) dEl.classList.add(holidayData[dateKey].type);
                if (new Date().toISOString().split('T')[0] === dateKey) dEl.classList.add('today');

                dEl.onclick = () => {
                    const types = [null, 'full', 'half', 'bank'];
                    let cur = types.indexOf(holidayData[dateKey]?.type || null);
                    let next = types[(cur + 1) % types.length];
                    if(!next) delete holidayData[dateKey];
                    else holidayData[dateKey] = { type: next, note: holidayData[dateKey]?.note || '' };
                    save(); renderYear();
                };
                cal.appendChild(dEl);
            }
            mDiv.appendChild(cal); grid.appendChild(mDiv);
        }
        renderNotes(); updateStats();
    }

    function renderNotes() {
        const container = document.getElementById('notesGrid');
        container.innerHTML = '';
        Object.keys(holidayData).filter(d => d.startsWith(yearInput.value)).sort().forEach(d => {
            const card = document.createElement('div');
            card.className = `note-card ${holidayData[d].type}`;
            card.innerHTML = `<div class="note-card-header"><strong>${d}</strong></div>
                <input type="text" value="${holidayData[d].note}" onchange="holidayData['${d}'].note=this.value; save()" placeholder="Note...">`;
            container.appendChild(card);
        });
    }

    function exportToCSV() {
        let csv = "Date,Type,Hours,Note\n";
        Object.keys(holidayData).sort().forEach(d => {
            const h = holidayData[d].type==='full'?9 : (holidayData[d].type==='half'?4:0);
            csv += `${d},${holidayData[d].type},${h},"${holidayData[d].note}"\n`;
        });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(new Blob([csv], {type:'text/csv'}));
        a.download = 'ireland_holidays.csv'; a.click();
    }

    yearInput.onchange = renderYear;
    allowanceInput.oninput = save;
    renderYear();
</script>
</body>
</html>



